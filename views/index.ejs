<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
    <meta name="google-site-verification" content="x9Bzc6Z3H_NSE4Ymzq2JZwdfkf6sByYxwX9UJm_49qQ" />
    <title><%= title %></title>
    <link rel='stylesheet' href='css/style.css' />

    <script src="js/main.js"></script>

    <script src="js/three.min.js"></script>
    <script src="js/threex.proceduralcity.js"></script>
    <script src="js/FirstPersonControls.js"></script>

  </head>
  <body style='margin: 0px; background-color: #d8e7ff; overflow: hidden;'>

    <script>
      var updateFcts  = [];
      var scene = new THREE.Scene();
      scene.fog = new THREE.FogExp2( 0xd0e0f0, 0.0025 );

      var renderer  = new THREE.WebGLRenderer( { antialias: false } );
      renderer.setSize( window.innerWidth, window.innerHeight );
      document.body.appendChild( renderer.domElement );

      //////////////////////////////////////////////////////////////////////////////////
      //    comment               //
      //////////////////////////////////////////////////////////////////////////////////

      var camera    = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.01, 3000)
      camera.position.y = 200

      //////////////////////////////////////////////////////////////////////////////////
      //    add an object and make it move          //
      //////////////////////////////////////////////////////////////////////////////////    
      var light = new THREE.HemisphereLight( 0xfffff0, 0x101020, 1.25 );
      light.position.set( 0.75, 1, 0.25 );
      scene.add( light );

      var material  = new THREE.MeshBasicMaterial({ color: 0x101018 })
      var geometry  = new THREE.PlaneGeometry( 2000, 2000 )
      var plane = new THREE.Mesh( geometry, material );
      plane.rotation.x= - 90 * Math.PI / 180;
      scene.add( plane );

      //////////////////////////////////////////////////////////////////////////////////
      //    comment               //
      //////////////////////////////////////////////////////////////////////////////////
      
      var city  = new THREEx.ProceduralCity()
      scene.add(city)
      
      
      //////////////////////////////////////////////////////////////////////////////////
      //    Camera Controls             //
      //////////////////////////////////////////////////////////////////////////////////
      var controls  = new THREE.FirstPersonControls( camera );
      controls.movementSpeed  = 20;
      controls.lookSpeed  = 0.05;
      controls.lookVertical = true;
      updateFcts.push(function(delta, now){
        controls.update( delta );   
      })

      //////////////////////////////////////////////////////////////////////////////////
      //    render the scene            //
      //////////////////////////////////////////////////////////////////////////////////
      updateFcts.push(function(){
        renderer.render( scene, camera );   
      })
      
      //////////////////////////////////////////////////////////////////////////////////
      //    loop runner             //
      //////////////////////////////////////////////////////////////////////////////////
      var lastTimeMsec= null
      requestAnimationFrame(function animate(nowMsec){
        // keep looping
        requestAnimationFrame( animate );
        // measure time
        lastTimeMsec  = lastTimeMsec || nowMsec-1000/60
        var deltaMsec = Math.min(200, nowMsec - lastTimeMsec)
        lastTimeMsec  = nowMsec
        // call each update function
        updateFcts.forEach(function(updateFn){
          updateFn(deltaMsec/1000, nowMsec/1000)
        })
      })
    </script>

    <div class="box">
      <a href="mailto:rich.awn@gmail.com" title="Email Us"><h1 id="logo"><%= title %></h1></a>
      <h3>Community. Industry. Liberty.</h3>

      <p>
      37 Box Street <br />
      Brooklyn, NY <br />
      </p>
      <p><span>(Click and hold on the background to fly around)</span></p>
    </div>

  </body>
</html>
